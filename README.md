# ðŸ¥ NodeJS QIWI SDK

Ð­Ñ‚Ð¾ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ‚Ð¸Ð¿Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° API ÐšÐ¸Ð²Ð¸ Ð‘Ð°Ð½ÐºÐ°

## Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ

- [ðŸ¥ NodeJS QIWI SDK](#-nodejs-qiwi-sdk)
  - [Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ](#ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ)
  - [ðŸ§¾ Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ](#-Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ)
  - [ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹](#Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹)
    - [ðŸ”Ž ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ðµ ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°](#-Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ-Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸-Ð¾-Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ðµ-ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°)
    - [ðŸ’° ÐšÐ°Ðº ÑÐ»Ð¸Ñ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°](#-ÐºÐ°Ðº-ÑÐ»Ð¸Ñ‚ÑŒ-Ð±Ð°Ð»Ð°Ð½Ñ-ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°)
    - [ðŸ”‘ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ñ‹ ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð´Ð»Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ñ P2P](#-ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ-Ð¿Ð°Ñ€Ñ‹-ÐºÐ»ÑŽÑ‡ÐµÐ¹-Ð´Ð»Ñ-Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ-Ñ-p2p)
    - [ðŸ§± ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð›Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² (Ð½Ð° TypeScript)](#-Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ-Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð²-Ð½Ð°-typescript)

## ðŸ§¾ Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

Ð’ ÐºÐ¾Ð´Ðµ Ð´Ð¾Ð²Ñ„Ð¸Ð³Ð° ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸ÐµÐ², Ð²Ð·ÑÑ‚Ñ‹Ñ… Ð¸Ð· Ð¾Ñ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ API,
Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ ÐµÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ `VSCode` Ð¸Ð»Ð¸ `WebStorm`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÑƒÐ¼ÐµÑŽÑ‚ Ð¸Ñ… Ð¿Ð¾Ð´Ð³Ñ€ÑƒÐ¶Ð°Ñ‚ÑŒ ÐºÐ°Ðº Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐ¸ Ð² ÐºÐ¾Ð´Ðµ, Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½ÑƒÑ‚ÑŒ.

`@todo` ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð´Ð¾ÐºÐ¸

## ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹

### ðŸ”Ž ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ðµ ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°

```javascript
const QIWI = require("qiwi-sdk");

const qp = new QIWI.Personal(process.env.QIWI_TOKEN);

qp.getPersonProfile().then(console.log);

// => { contractInfo: {...}, authInfo: {...}, userInfo: {...} }
```

### ðŸ’° ÐšÐ°Ðº ÑÐ»Ð¸Ñ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ ÐºÐ¾ÑˆÐµÐ»ÑŒÐºÐ°

**Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ð´ÐµÐ»Ð°ÐµÑ‚Ðµ ÑÑ‚Ð¾ Ð´Ñ€ÑƒÐ³Ð¸Ð¼ Ð»ÑŽÐ´ÑÐ¼ Ð±ÐµÐ· Ð¸Ñ… ÑÐ¾Ð³Ð»Ð°ÑÐ¸Ñ - ÑÑ‚Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð¾Ð·Ð°ÐºÐ¾Ð½Ð½Ð¾, Ñ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽ ÑÑ‚Ð¾ Ñ‚ÑƒÑ‚, Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð¾Ð³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ API**

```javascript
const QIWI = require("qiwi-sdk");

const qp = new QIWI.Personal(process.env.QIWI_TOKEN);
const receiver = "+79123456789";
const provider = 99;

async function main() {
  const profile = await qp.getPersonProfile();
  const wallet = profile.authInfo.personId.toString();
  const accounts = await qp.getAccounts(wallet);

  const rubleAccount = accounts.find(
    (accumulator) =>
      accumulator.balance &&
      accumulator.balance.currency === Personal.Currency.RUB
  );

  const commission = await qp.getCommission(
    provider,
    receiver,
    rubleAccount.balance.amount
  );

  const totalToSteal = rubleAccount.balance.amount - commission;

  const payment = await qp.pay(provider, receiver, totalToSteal);

  console.log(payment);
}

main();
```

### ðŸ”‘ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ñ‹ ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð´Ð»Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ñ P2P

```javascript
const QIWI = require("qiwi-sdk");

const qp = new QIWI.Personal(process.env.QIWI_TOKEN);

async function main() {
  const profile = await qp.getPersonProfile();
  const wallet = profile.authInfo.personId;

  const [pk, sk] = await qp.createP2PKeyPair("My super pair name");

  // Ð”Ð°, Ð¾Ð½Ð¸ Ð¸Ð½Ð²ÐµÑ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ,
  // Ñ‚Ð°Ðº ÐºÐ°Ðº PublicKey Ð½Ðµ Ð²ÑÐµÐ³Ð´Ð° Ð½ÑƒÐ¶ÐµÐ½
  const p2pc = new QIWI.P2P(sk, pk);

  const bill = await p2pc.createBill({
    amount: {
      value: 1000,
      currency: QIWI.P2P.Currency.RUB
    },
    expirationDateTime: QIWI.P2P.formatLifetime(2 /* 2 Ð´Ð½Ñ */),
    comment: "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ°Ð¹Ñ‚Ð° pornhub.com"
  });

  console.log(bill.payUrl);
}

main();
```

### ðŸ§± ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð›Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² (Ð½Ð° TypeScript)

```typescript
import { Personal } from "qiwi-sdk";

const qp = new Personal(process.env.QIWI_TOKEN);

async function main() {
  const { limits } = await qp.getLimits(process.env.QIWI_WALLET as string, [
    Personal.LimitType.TURNOVER
  ]);

  const [limit] = limits.RU;

  console.log(limit);
  // => { type: "TURNOVER", currency: "RUB", max: 400000, spent: 0, rest: 400000, ... }
}
```
